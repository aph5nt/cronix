<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>The startup script manual
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Cron Library"/>
    <meta name="author" content="aph5nt"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/cronix/content/style.css" />
    <script type="text/javascript" src="/cronix/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/aph5nt/cronix">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/cronix/index.html">cronix</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<p>Defining and configuring jobs with startup.fsx file.</p>

<h1><a name="The-startup-script-manual" class="anchor" href="#The-startup-script-manual">The startup script manual</a></h1>

<p>Introduction: What is startup.fsx file for?</p>

<p>The intention of having a seperate file for configuring jobs, is to give developers the flexibility and ease of use.
In the startup.fsx file, developer can configure and schedule jobs embeded in the service assembly and also reference 
external assemblies and create custom jobs on fly!
Startup script is compiled on the Cronix service startup time.</p>

<p>Sample script:</p>

<ul>
<li>Lets take a look how does the minimalistic startup.fsx file looks like.</li>
</ul>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// We reference assemblies for Visual Studio intellisense support.</span>
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;.&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Debug&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Release&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Cronix.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.exe&quot;</span><span class="inactive"> </span><span class="inactive">//</span><span class="inactive"> </span><span class="inactive">this</span><span class="inactive"> </span><span class="inactive">is</span><span class="inactive"> </span><span class="inactive">our</span><span class="inactive"> </span><span class="inactive">executable</span><span class="inactive"> </span><span class="inactive">where</span><span class="inactive"> </span><span class="inactive">we</span><span class="inactive"> </span><span class="inactive">had</span><span class="inactive"> </span><span class="inactive">initialized</span><span class="inactive"> </span><span class="inactive">Cronix</span><span class="inactive"> </span><span class="inactive">service.</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Chessie.dll&quot;</span>
<span class="prep">#endif</span>

<span class="c">/// This namespace is required.</span>
<span class="k">namespace</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Startup</span>

<span class="c">/// This module is required.</span>
<span class="k">module</span> <span class="i">RunAtStartup</span> <span class="o">=</span>
    
    <span class="k">open</span> <span class="i">System</span><span class="o">.</span><span class="i">Threading</span>
    <span class="k">open</span> <span class="i">System</span>
    <span class="k">open</span> <span class="i">Cronix</span>
    <span class="k">open</span> <span class="i">CSharpSample</span><span class="o">.</span><span class="i">Jobs</span>

    <span class="c">/// startup method</span>
    <span class="k">let</span> <span class="i">start</span> (<span class="i">scheduler</span> <span class="o">:</span> <span class="i">IScheduleManager</span>) <span class="o">=</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;my job name&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">sampleJob</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
        ()
</pre>
</td>
</tr>
</table>

<p>and more complex example...</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;.&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Debug&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Release&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Cronix.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.exe&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.Jobs.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Chessie.dll&quot;</span>
<span class="inactive">//#r</span><span class="inactive"> </span><span class="inactive">&quot;YourTask.dll&quot;</span>
<span class="prep">#endif</span>

<span class="k">namespace</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Startup</span>

<span class="k">module</span> <span class="i">RunAtStartup</span> <span class="o">=</span>
    
    <span class="k">open</span> <span class="i">System</span><span class="o">.</span><span class="i">Threading</span>
    <span class="k">open</span> <span class="i">System</span>
    <span class="k">open</span> <span class="i">Cronix</span>

    <span class="c">//reference yours custom assembly here</span>
    <span class="k">open</span> <span class="i">CSharpSample</span>
    <span class="k">open</span> <span class="i">CSharpSample</span><span class="o">.</span><span class="i">Jobs</span>

    <span class="c">// inline job</span>
    <span class="k">let</span> <span class="i">sampleJob</span> (<span class="i">token</span> <span class="o">:</span> <span class="i">CancellationToken</span>) <span class="o">=</span> 
      <span class="i">printf</span> <span class="s">&quot;callback executed at (UTC) %s\n&quot;</span> <span class="o">&lt;|</span> <span class="i">DateTime</span><span class="o">.</span><span class="i">UtcNow</span><span class="o">.</span><span class="i">ToString</span>()
      <span class="i">Thread</span><span class="o">.</span><span class="i">Sleep</span> <span class="n">100</span>

    <span class="k">let</span> <span class="i">start</span> (<span class="i">scheduler</span> <span class="o">:</span> <span class="i">IScheduleManager</span>) <span class="o">=</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;inline job&quot;</span> <span class="o">&lt;|</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">sampleJob</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;job from external assembly&quot;</span> <span class="o">&lt;|</span>  <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">ExternalJobs</span><span class="o">.</span><span class="i">Callback</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;job defined inside the cronix service&quot;</span> <span class="o">&lt;|</span>  <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">EmbededJobs</span><span class="o">.</span><span class="i">Callback</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;with frequency helper&quot;</span> <span class="o">&lt;|</span> <span class="i">frequency</span> <span class="i">Hourly</span> <span class="o">&lt;|</span> <span class="i">Callback</span>( <span class="i">sampleJob</span> ) <span class="o">|&gt;</span> <span class="i">ignore</span>
        ()
</pre>
</td>
</tr>
</table>

<p>Adding Startup.fsx file to the Cronix service</p>

<ul>
<li>Just create new Startup.fsx file inside your Cronix project root directory, type your code there (use one of these samples) and change file property 'Copy to Output Directory' to 'Copy always'.</li>
</ul>


        </div>
        <div class="span3">
          <img src="/cronix/img/logo.png" alt="Cronix" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">cronix</li>
            <li><a href="/cronix/index.html">Home page</a></li>
            <li class="divider"></li>

            <li><a href="http://nuget.org/packages/cronix">Get Library via NuGet</a></li>
            <li><a href="http://github.com/aph5nt/cronix">Source Code on GitHub</a></li>

            <li><a href="/cronix/license.html">License</a></li>
            <li><a href="/cronix/release-notes.html">Release Notes</a></li>
            

			<li class="nav-header">The Architecture Overview</li>
			<li><a href="/cronix/the big picture.html">The Big Picture</a></li>
			 
            <li class="nav-header">The developer's guide</li>
			<li><a href="/cronix/developers guide.html#creating new project">Creating new project</a></li>
			<li><a href="/cronix/developers guide.html#configuration">Configuration</a></li>
			<li><a href="/cronix/developers guide.html#web ui">Web UI</a></li>
			<li><a href="/cronix/developers guide.html#job scheduling">Job scheduling</a></li>
			
			<li><a href="/cronix/developers guide.html#windows service">Windows service</a></li>
			<li><a href="/cronix/reference/index.html">API Reference</a></li>
			
			<li class="nav-header">Samples</li>
		  	<li><a href="https://github.com/aph5nt/cronix/tree/master/docs/samples/FSharpSample">Generic F# sample</a></li>
			<li><a href="https://github.com/aph5nt/cronix/tree/master/docs/samples/CSharpSample">Generic C# sample</a></li>
			<li><a href="https://github.com/aph5nt/cronix/blob/master/docs/samples/BitstampTicker">Bitstamp Ticker</a></li>
 
			
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/aph5nt/cronix"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
