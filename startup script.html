<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>The startup script manual
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Cron Library"/>
    <meta name="author" content="aph5nt"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/cronix/content/style.css" />
    <script type="text/javascript" src="/cronix/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/aph5nt/cronix">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/cronix/index.html">cronix</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<p>Defining and configuring jobs with startup.fsx file.</p>

<h1><a name="The-startup-script-manual" class="anchor" href="#The-startup-script-manual">The startup script manual</a></h1>

<p>Introduction: What is startup.fsx file for?</p>

<p>The intention of having a seperate file for configuring jobs, is to give developers the flexibility and ease of use.
In the startup.fsx file, developer can configure and schedule jobs embeded in the service assembly and also reference 
external assemblies and create custom jobs on fly!
Startup script is compiled on the Cronix service startup time.</p>

<p>Sample script:</p>

<ul>
<li>Lets take a look how does the minimalistic startup.fsx file looks like.</li>
</ul>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// We reference assemblies for Visual Studio intellisense support.</span>
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;.&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Debug&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Release&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Cronix.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.exe&quot;</span><span class="inactive"> </span><span class="inactive">//</span><span class="inactive"> </span><span class="inactive">this</span><span class="inactive"> </span><span class="inactive">is</span><span class="inactive"> </span><span class="inactive">our</span><span class="inactive"> </span><span class="inactive">executable</span><span class="inactive"> </span><span class="inactive">where</span><span class="inactive"> </span><span class="inactive">we</span><span class="inactive"> </span><span class="inactive">had</span><span class="inactive"> </span><span class="inactive">initialized</span><span class="inactive"> </span><span class="inactive">Cronix</span><span class="inactive"> </span><span class="inactive">service.</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Chessie.dll&quot;</span>
<span class="prep">#endif</span>

<span class="c">/// This namespace is required.</span>
<span class="k">namespace</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Startup</span>

<span class="c">/// This module is required.</span>
<span class="k">module</span> <span class="t">RunAtStartup</span> <span class="o">=</span>
    
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Threading</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 3)" onmouseover="showTip(event, 'fs1', 3)" class="i">System</span>
    <span class="k">open</span> <span class="i">Cronix</span>
    <span class="k">open</span> <span class="i">Messages</span>
    <span class="k">open</span> <span class="i">CSharpSample</span><span class="o">.</span><span class="i">Jobs</span>

    <span class="c">/// startup method</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="f">start</span> (<span onmouseout="hideTip(event, 'fs4', 5)" onmouseover="showTip(event, 'fs4', 5)" class="i">scheduler</span> <span class="o">:</span> <span class="i">IScheduleManager</span>) <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs4', 6)" onmouseover="showTip(event, 'fs4', 6)" class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;my job name&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">sampleJob</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="f">ignore</span>
        ()
</pre>
</td>
</tr>
</table>

<p>and more complex example...</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
<span class="l">31: </span>
<span class="l">32: </span>
<span class="l">33: </span>
<span class="l">34: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;.&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Debug&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Release&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Cronix.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.exe&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;CSharpSample.Jobs.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Chessie.dll&quot;</span>
<span class="inactive">//#r</span><span class="inactive"> </span><span class="inactive">&quot;YourTask.dll&quot;</span>
<span class="prep">#endif</span>

<span class="k">namespace</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Startup</span>

<span class="k">module</span> <span class="t">RunAtStartup</span> <span class="o">=</span>
    
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 8)" onmouseover="showTip(event, 'fs1', 8)" class="i">System</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 9)" onmouseover="showTip(event, 'fs2', 9)" class="i">Threading</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 10)" onmouseover="showTip(event, 'fs1', 10)" class="i">System</span>
    <span class="k">open</span> <span onmouseout="hideTip(event, 'fs6', 11)" onmouseover="showTip(event, 'fs6', 11)" class="i">Cronix</span>
    <span class="k">open</span> <span class="i">Messages</span>

    <span class="c">//reference yours custom assembly here</span>
    <span class="k">open</span> <span class="i">CSharpSample</span>
    <span class="k">open</span> <span class="i">CSharpSample</span><span class="o">.</span><span class="i">Jobs</span>

    <span class="c">// inline job</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 12)" onmouseover="showTip(event, 'fs7', 12)" class="f">sampleJob</span> (<span onmouseout="hideTip(event, 'fs8', 13)" onmouseover="showTip(event, 'fs8', 13)" class="i">token</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs9', 14)" onmouseover="showTip(event, 'fs9', 14)" class="t">CancellationToken</span>) <span class="o">=</span> 
      <span onmouseout="hideTip(event, 'fs10', 15)" onmouseover="showTip(event, 'fs10', 15)" class="f">printf</span> <span class="s">&quot;callback executed at (UTC) </span><span class="pf">%s</span><span class="s"></span><span class="e">\n</span><span class="s">&quot;</span> <span class="o">&lt;|</span> <span onmouseout="hideTip(event, 'fs11', 16)" onmouseover="showTip(event, 'fs11', 16)" class="t">DateTime</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="i">UtcNow</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="f">ToString</span>()
      <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="t">Thread</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="f">Sleep</span> <span class="n">100</span>

    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="f">start</span> (<span onmouseout="hideTip(event, 'fs4', 22)" onmouseover="showTip(event, 'fs4', 22)" class="i">scheduler</span> <span class="o">:</span> <span class="i">IScheduleManager</span>) <span class="o">=</span>
        <span onmouseout="hideTip(event, 'fs4', 23)" onmouseover="showTip(event, 'fs4', 23)" class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;inline job&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span onmouseout="hideTip(event, 'fs7', 24)" onmouseover="showTip(event, 'fs7', 24)" class="i">sampleJob</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 25)" onmouseover="showTip(event, 'fs5', 25)" class="f">ignore</span>
        <span onmouseout="hideTip(event, 'fs4', 26)" onmouseover="showTip(event, 'fs4', 26)" class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;job from external assembly&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">ExternalJobs</span><span class="o">.</span><span class="i">Callback</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 27)" onmouseover="showTip(event, 'fs5', 27)" class="f">ignore</span>
        <span onmouseout="hideTip(event, 'fs4', 28)" onmouseover="showTip(event, 'fs4', 28)" class="i">scheduler</span><span class="o">.</span><span class="i">Schedule</span> <span class="s">&quot;job defined inside the cronix service&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">Callback</span>(<span class="i">EmbededJobs</span><span class="o">.</span><span class="i">Callback</span>) <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs5', 29)" onmouseover="showTip(event, 'fs5', 29)" class="f">ignore</span>
        ()
</pre>
</td>
</tr>
</table>

<p>Adding Startup.fsx file to the Cronix service</p>

<ul>
<li>Just create new Startup.fsx file inside your Cronix project root directory, type your code there (use one of these samples) and change file property 'Copy to Output Directory' to 'Copy always'.</li>
</ul>

<div class="tip" id="fs1">namespace System</div>
<div class="tip" id="fs2">namespace System.Threading</div>
<div class="tip" id="fs3">val start : scheduler:&#39;a -&gt; unit<br /><br />Full name: Cronix.Startup.RunAtStartup.start<br /><em><br /><br />&#160;startup method</em></div>
<div class="tip" id="fs4">val scheduler : &#39;a</div>
<div class="tip" id="fs5">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>
<div class="tip" id="fs6">namespace Cronix</div>
<div class="tip" id="fs7">val sampleJob : token:CancellationToken -&gt; unit<br /><br />Full name: Cronix.Startup.RunAtStartup.sampleJob</div>
<div class="tip" id="fs8">val token : CancellationToken</div>
<div class="tip" id="fs9">Multiple items<br />type CancellationToken =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : canceled:bool -&gt; CancellationToken<br />&#160;&#160;&#160;&#160;member CanBeCanceled : bool<br />&#160;&#160;&#160;&#160;member Equals : other:CancellationToken -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member IsCancellationRequested : bool<br />&#160;&#160;&#160;&#160;member Register : callback:Action -&gt; CancellationTokenRegistration + 3 overloads<br />&#160;&#160;&#160;&#160;member ThrowIfCancellationRequested : unit -&gt; unit<br />&#160;&#160;&#160;&#160;member WaitHandle : WaitHandle<br />&#160;&#160;&#160;&#160;static member None : CancellationToken<br />&#160;&#160;end<br /><br />Full name: System.Threading.CancellationToken<br /><br />--------------------<br />CancellationToken()<br />CancellationToken(canceled: bool) : unit</div>
<div class="tip" id="fs10">val printf : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printf</div>
<div class="tip" id="fs11">Multiple items<br />type DateTime =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; DateTime + 10 overloads<br />&#160;&#160;&#160;&#160;member Add : value:TimeSpan -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddDays : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddHours : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMilliseconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMinutes : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddMonths : months:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddSeconds : value:float -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddTicks : value:int64 -&gt; DateTime<br />&#160;&#160;&#160;&#160;member AddYears : value:int -&gt; DateTime<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.DateTime<br /><br />--------------------<br />DateTime()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : unit<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="tip" id="fs12">property DateTime.UtcNow: DateTime</div>
<div class="tip" id="fs13">DateTime.ToString() : string<br />DateTime.ToString(provider: IFormatProvider) : string<br />DateTime.ToString(format: string) : string<br />DateTime.ToString(format: string, provider: IFormatProvider) : string</div>
<div class="tip" id="fs14">Multiple items<br />type Thread =<br />&#160;&#160;inherit CriticalFinalizerObject<br />&#160;&#160;new : start:ThreadStart -&gt; Thread + 3 overloads<br />&#160;&#160;member Abort : unit -&gt; unit + 1 overload<br />&#160;&#160;member ApartmentState : ApartmentState with get, set<br />&#160;&#160;member CurrentCulture : CultureInfo with get, set<br />&#160;&#160;member CurrentUICulture : CultureInfo with get, set<br />&#160;&#160;member DisableComObjectEagerCleanup : unit -&gt; unit<br />&#160;&#160;member ExecutionContext : ExecutionContext<br />&#160;&#160;member GetApartmentState : unit -&gt; ApartmentState<br />&#160;&#160;member GetCompressedStack : unit -&gt; CompressedStack<br />&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;...<br /><br />Full name: System.Threading.Thread<br /><br />--------------------<br />Thread(start: ThreadStart) : unit<br />Thread(start: ParameterizedThreadStart) : unit<br />Thread(start: ThreadStart, maxStackSize: int) : unit<br />Thread(start: ParameterizedThreadStart, maxStackSize: int) : unit</div>
<div class="tip" id="fs15">Thread.Sleep(timeout: TimeSpan) : unit<br />Thread.Sleep(millisecondsTimeout: int) : unit</div>
<div class="tip" id="fs16">val start : scheduler:&#39;a -&gt; unit<br /><br />Full name: Cronix.Startup.RunAtStartup.start</div>

        </div>
        <div class="span3">
          <img src="/cronix/img/logo.png" alt="Cronix" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">cronix</li>
            <li><a href="/cronix/index.html">Home page</a></li>
            <li class="divider"></li>

            <li><a href="http://nuget.org/packages/cronix">Get Library via NuGet</a></li>
            <li><a href="http://github.com/aph5nt/cronix">Source Code on GitHub</a></li>

            <li><a href="/cronix/license.html">License</a></li>
            <li><a href="/cronix/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>

            <li><a href="/cronix/cronix setup.html">Cronix setup manual</a></li>
		  	<li><a href="/cronix/startup script.html">Startup script configuration manual</a></li>
		  	<li><a href="https://github.com/aph5nt/cronix/tree/master/docs/samples">Samples</a></li>
		  	

            <li class="nav-header">Documentation</li>
            <li><a href="/cronix/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/aph5nt/cronix"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
