<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>The developer's guide
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Cron Library"/>
    <meta name="author" content="aph5nt"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/cronix/content/style.css" />
    <script type="text/javascript" src="/cronix/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/aph5nt/cronix">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/cronix/index.html">cronix</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="The-developer-s-guide" class="anchor" href="#The-developer-s-guide">The developer's guide</a></h1>

<h2><a name="Creating-new-project" class="anchor" href="#Creating-new-project">Creating new project</a></h2>

<p>The best point to get started with Cronix library is to take a look at the Generic Sample Projects. They can be found here
The following developer's guide will briefly walk througth some important topics which are worth to mention.</p>

<h2><a name="Configuration" class="anchor" href="#Configuration">Configuration</a></h2>

<ul>
<li><p>Logging</p>
<p>By deafult, Cronix uses NLOG library for logging. To enable logging the NLOG.config file should be added to your Cronix project.</p></li>
</ul>

<h2><a name="WebUI" class="anchor" href="#WebUI">WebUI</a></h2>

<ul>
<li><p>Configuration</p>
<p>Cronix supports self-hosted web interface. By default it uses the 8111 port. In order to change it, add the following key in the app.config file into appSettings section</p>
<pre>&lt;add key="host.port" value="8080" /&gt; </pre>
<p>If the default port value is changed, then the global variable named "connectionUrl" in the webui/index.html file must also be changed.</p>
<pre>
&lt;!-- GLOBAL CONFIGURATION --> 
&lt;script type="text/javascript"&gt;
var connectionUrl = "http://localhost:8111/signalr";
&lt;/script&gt;
</pre></li>
</ul>

<ul>
<li><p>Overview</p>
<p><img src="img\webui.PNG" alt="webui"></p>
<p>In order to enable webui, the Cronix.Web package must be installed and the WebPlugin must be initialized while bootstraping (as on snippet bellow).</p>
<p>F# Sample</p></li>
</ul>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span class="i">System</span>
<span class="k">open</span> <span class="i">Cronix</span>
<span class="k">open</span> <span class="i">Chessie</span><span class="o">.</span><span class="i">ErrorHandling</span>
<span class="k">open</span> <span class="i">System</span><span class="o">.</span><span class="i">Threading</span>
<span class="k">open</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Web</span>
 
[&lt;<span class="i">EntryPoint</span>&gt;]
<span class="k">let</span> <span class="i">main</span> <span class="i">argv</span> <span class="o">=</span> 
 
    <span class="k">let</span> <span class="i">startupHandler</span> <span class="o">=</span> 
        <span class="k">new</span> <span class="i">StartupHandler</span>(
            <span class="k">fun</span>(<span class="i">scheduler</span>) <span class="k">-&gt;</span>
                        <span class="i">WebPlugin</span><span class="o">.</span><span class="i">InitPlugin</span>(<span class="i">scheduler</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
            )

    <span class="i">BootStrapper</span><span class="o">.</span><span class="i">InitService</span>(<span class="i">argv</span>, <span class="i">startupHandler</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
    <span class="n">0</span> <span class="c">// return an integer exit code</span>
</pre>
</td>
</tr>
</table>

<p>C# Sample</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="i">Main</span>(<span class="i">string</span>[] <span class="i">args</span>)
{
    <span class="i">BootStrapper</span><span class="o">.</span><span class="i">InitService</span>(<span class="i">args</span>, <span class="i">scheduler</span> <span class="o">=&gt;</span>
    {
        <span class="i">WebPlugin</span><span class="o">.</span><span class="i">InitPlugin</span>(<span class="i">scheduler</span>);
    });
}
</pre>
</td>
</tr>
</table>

<h2><a name="Job-scheduling" class="anchor" href="#Job-scheduling">Job scheduling</a></h2>

<ul>
<li>Build-in schedules</li>
</ul>

<p>A Build in schedule is a hardcoded schedule definition that will create a trigger for a job at each Cronix application startup. Even if that trigger will be uncheduled, it will reschedule again after restart of your application.</p>

<p>C# Sample - build-in schedule:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="i">Main</span>(<span class="i">string</span>[] <span class="i">args</span>)
{
    <span class="i">BootStrapper</span><span class="o">.</span><span class="i">InitService</span>(<span class="i">args</span>, <span class="i">scheduler</span> <span class="o">=&gt;</span>
    {
        <span class="i">scheduler</span><span class="o">.</span><span class="i">ScheduleJob</span>(<span class="s">&quot;scheduled job&quot;</span>, <span class="s">&quot;* * * * *&quot;</span>, <span class="i">EmbededJobs</span><span class="o">.</span><span class="i">Callback</span>);
        <span class="i">scheduler</span><span class="o">.</span><span class="i">ScheduleJob</span>(<span class="s">&quot;scheduled job&quot;</span>, <span class="i">Dsl</span><span class="o">.</span><span class="i">frequency</span>(<span class="i">Dsl</span><span class="o">.</span><span class="i">CronExpr</span><span class="o">.</span><span class="i">Daily</span>), <span class="i">EmbededJobs</span><span class="o">.</span><span class="i">Callback</span>);
    });
}
</pre>
</td>
</tr>
</table>

<ul>
<li>StartupScript</li>
</ul>

<p>Having a startup script gives the ability to add custom jobs to your application without need od recompilation of your Cronix project.
Custom dll's can be referenced, and the new schedule definitions can be freely modified.
The Startup.fsx file must be placed in your Cronix project (it must have 'Copy to build directory' property set to True).
It must follow the namespace, module and start method convention.</p>

<p>Sample startup script:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="prep">#if</span> <span class="i">INTERACTIVE</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;.&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Debug&quot;</span>
<span class="inactive">#I</span><span class="inactive"> </span><span class="inactive">&quot;bin\Release&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Cronix.dll&quot;</span>
<span class="inactive">#r</span><span class="inactive"> </span><span class="inactive">&quot;Chessie.dll&quot;</span>
<span class="prep">#endif</span>

<span class="k">namespace</span> <span class="i">Cronix</span><span class="o">.</span><span class="i">Startup</span>

<span class="k">module</span> <span class="i">RunAtStartup</span> <span class="o">=</span>
    
    <span class="k">open</span> <span class="i">System</span><span class="o">.</span><span class="i">Threading</span>
    <span class="k">open</span> <span class="i">System</span>
    <span class="k">open</span> <span class="i">Cronix</span>

    <span class="c">/// sample job</span>
    <span class="k">let</span> <span class="i">sampleJob</span> (<span class="i">token</span> <span class="o">:</span> <span class="i">CancellationToken</span>) <span class="o">=</span> 
      <span class="i">printf</span> <span class="s">&quot;callback executed at (UTC) %s\n&quot;</span> <span class="o">&lt;|</span> <span class="i">DateTime</span><span class="o">.</span><span class="i">UtcNow</span><span class="o">.</span><span class="i">ToString</span>()
      <span class="i">Thread</span><span class="o">.</span><span class="i">Sleep</span> <span class="n">100</span>

    <span class="k">let</span> <span class="i">start</span> (<span class="i">scheduler</span> <span class="o">:</span> <span class="i">IScheduleManager</span>) <span class="o">=</span>

        <span class="c">// schedules goes here!</span>
        <span class="i">scheduler</span><span class="o">.</span><span class="i">ScheduleJob</span> <span class="s">&quot;job1&quot;</span> <span class="s">&quot;* * * * *&quot;</span> <span class="o">&lt;|</span> <span class="i">JobCallback</span>(<span class="i">sampleJob</span>) <span class="o">|&gt;</span> <span class="i">ignore</span>
        ()
</pre>
</td>
</tr>
</table>

<h2><a name="Windows-service" class="anchor" href="#Windows-service">Windows service</a></h2>

<p>In order to see what are the availiable command line options, run your Cronix application in the command line without any parameters.
The sample usage will be shown as in sample bellow.</p>

<div class="row">
<div class="span12">
<div class="well well-small">
<pre>
C:\&gt;YourCronixApp.exe
Usage:
YourCronixApp debug
    - Starts 'YourCronixApp' in the interactive mode.
YourCronixApp install
    - Installs 'YourCronixApp' as a Windows service.
YourCronixApp uninstall
    - Uninstalls 'YourCronixApp' as a Windows service.
</pre>
</div>
</div>
</div>


        </div>
        <div class="span3">
          <img src="/cronix/img/logo.png" alt="Cronix" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">cronix</li>
            <li><a href="/cronix/index.html">Home page</a></li>
            <li class="divider"></li>

            <li><a href="http://nuget.org/packages/cronix">Get Library via NuGet</a></li>
            <li><a href="http://github.com/aph5nt/cronix">Source Code on GitHub</a></li>

            <li><a href="/cronix/license.html">License</a></li>
            <li><a href="/cronix/release-notes.html">Release Notes</a></li>
            

			<li class="nav-header">The Architecture Overview</li>
			<li><a href="/cronix/the big picture.html">The Big Picture</a></li>
			 
            <li class="nav-header">The developer's guide</li>
			<li><a href="/cronix/developers guide.html#creating new project">Creating new project</a></li>
			<li><a href="/cronix/developers guide.html#configuration">Configuration</a></li>
			<li><a href="/cronix/developers guide.html#web ui">Web UI</a></li>
			<li><a href="/cronix/developers guide.html#job scheduling">Job scheduling</a></li>
			
			<li><a href="/cronix/developers guide.html#windows service">Windows service</a></li>
			<li><a href="/cronix/reference/index.html">API Reference</a></li>
			
			<li class="nav-header">Samples</li>
		  	<li><a href="https://github.com/aph5nt/cronix/tree/master/docs/samples/FSharpSample">Generic F# sample</a></li>
			<li><a href="https://github.com/aph5nt/cronix/tree/master/docs/samples/CSharpSample">Generic C# sample</a></li>
			<li><a href="https://github.com/aph5nt/cronix/blob/master/docs/samples/BitstampTicker">Bitstamp Ticker</a></li>
 
			
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/aph5nt/cronix"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
